<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Естествоинформатика - Микро- и макропараметры</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../03-molecular-mechanics/4-force-fields.html" rel="next">
<link href="../03-molecular-mechanics/2-integration.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Поиск не дал результатов",
    "search-matching-documents-text": "Результаты поиска",
    "search-copy-link-title": "Скопировать ссылку",
    "search-hide-matches-text": "Скрыть дополнительные результаты",
    "search-more-match-text": "дополнительный результат в этом документе",
    "search-more-matches-text": "дополнительных результата(-ов) в этом документе",
    "search-clear-button-title": "Очистить",
    "search-detached-cancel-button-title": "Отменить",
    "search-submit-button-title": "Найти",
    "search-label": "Поиск"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JZGJWN0T0F"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-JZGJWN0T0F', { 'anonymize_ip': true});
</script>
<script>
window.MathJax = {
  options: {
    enableMenu: false,
  },
};
</script>

</head><body class="nav-sidebar floating"><div class="hidden">
$$
\require{color}
\require{physics}

\def\bb{\mathbb}
\def\bf{\mathbf}
\def\cl{\mathcal}
\def\rm{\mathrm}
\def\bm{\boldsymbol}
\def\t{\text}
\def\u{\rm}
\def\R{\bb R}
\def\N{\bb N}
\def\Z{\bb Z}
\def\Q{\bb Q}
\def\C{\bb C}
\def\A{\forall}
\def\E{\exists}
\def\To{\Rightarrow}
\def\dag{\dagger}
\def\AA{\unicode{x212B}}
\def\const{\rm{const}}
\def\t{\text}
\def\ub{\underbrace}
\def\l{\left}
\def\r{\right}
\newcommand{\hi}[1] {{\color{blue} #1}}
\renewcommand{\epsilon}{\varepsilon}
\renewcommand{\phi}{\varphi}
\renewcommand{\dd}{\, \rm d}
$$
</div>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>





<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../03-molecular-mechanics/1-interactions.html">Молекулярная динамика</a></li><li class="breadcrumb-item"><a href="../03-molecular-mechanics/3-micro--and-macroparameters.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Микро- и макропараметры</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../assets/logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Естествоинформатика</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://sheg.cc" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-house"></i></a>
    <a href="https://github.com/vsheg/naturoinformatics" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Переключить темный режим"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Поиск"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Добро пожаловать</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../00-intro/notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Обозначения</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Квантовая механика</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-quantum-mechanincs/0-quantum-mechanics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Квантовая механика</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-quantum-mechanincs/1-wave-function.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Волновое уравнение</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-quantum-mechanincs/2-state-vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Векторы состояния</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-quantum-mechanincs/3-schrodinger-equation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Уравнение Шрёдингера</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-quantum-mechanincs/4-hydrogen-like-ion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Водородоподобный ион</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-quantum-mechanincs/5-basis-sets.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Базисы</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Молекулярная динамика</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-molecular-mechanics/1-interactions.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Молекулярные взаимодействия</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-molecular-mechanics/2-integration.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Интегрирование уравнений движения</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-molecular-mechanics/3-micro--and-macroparameters.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Микро- и макропараметры</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-molecular-mechanics/4-force-fields.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Силовые поля</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-molecular-mechanics/5-trajectories.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Анализ траекторий</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Ускоренный семплинг</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-enhanced-sampling/1-metadynamics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Метадинамика</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Виртуальный скрининг</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06-virtual-screening/1-docking.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Методы расчёта свободной энергии</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Рассчёт свободной энергии</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07-free-energy-calculation/1-fep.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Теория возмущений свободной энергии</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07-free-energy-calculation/2-alchemy.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Вычислительная алхимия</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Хемоинформатика</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-chemoinformatics/1-chemoinformatics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Хемоинформатика</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Разделы</h2>
   
  <ul>
  <li><a href="#sec-temperature" id="toc-sec-temperature" class="nav-link active" data-scroll-target="#sec-temperature">Температура</a></li>
  <li><a href="#sec-pressure" id="toc-sec-pressure" class="nav-link" data-scroll-target="#sec-pressure">Давление</a></li>
  <li><a href="#размер" id="toc-размер" class="nav-link" data-scroll-target="#размер">Размер</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography">Источники</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Микро- и макропараметры</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Для описания МД систем применяют методы статистической механики, биологические системы обычно моделируют в NPT-ансамбле, в нём число частиц, давление и температура принимаются неизменными.</p>
<section id="sec-temperature" class="level2">
<h2 class="anchored" data-anchor-id="sec-temperature">Температура</h2>
<p>Мгновенную полную энергию системы <span class="math inline">\(E\)</span> можно определить простым суммированием по кинетическим энергиям и по полным потенциалам взаимодействия двух частиц: <span class="math display">\[
E(t)=\sum_{i}\dfrac{m_{i}{\bf v}_{i}^{2}(t)}{2}+\sum_{i&lt;j}U_{i,j},
\]</span> каждое парное взаимодействие входит в выражение лишь единожды.</p>
<p>Температура непосредственно связана со средней (по частицам) кинетической энергией, приходящейся на одну степень свободы: <span id="eq-T-instant"><span class="math display">\[
T(t)=\dfrac{2}{3kN}\sum_{i}\dfrac{m_{i}{\bf {\bf v}}_{i}^{2}(t)}{2},
\tag{9.1}\]</span></span> видно, что температура неявным образом зависит от времени, что нарушает предпосылки NPT-ансамбля, это противоречие можно устранить введя ограничение на среднюю кинетическую скорость.</p>
<p>Согласно <a href="#eq-T-instant">Ур.&nbsp;<span>9.1</span></a>, разность мгновенной <span class="math inline">\(T(t)\)</span> и фиксированной в ансамбле <span class="math inline">\(\Theta\)</span> температур</p>
<p><span class="math display">\[
\Delta T=T(t)-\Theta=\dfrac{2}{3kN}\left\{ \sum_{i}\lambda^{2}{\bf v}_{i}^{2}(t)-\sum_{i}{\bf v}_{i}^{2}(t)\right\},
\]</span> коэффициент <span class="math inline">\(\lambda\)</span> — некий параметр, показывающий среднее отклонение мгновенных скоростей от ожидаемых в условиях NPT-ансамбля, выделив явно: <span class="math display">\[
\lambda=\sqrt{\dfrac{\Theta}{T(t)}},
\]</span> этот параметр масштабирования скоростей включается на каждом шаге интегрирования: <span class="math display">\[
{\bf v}_{i}(t+\delta t)\gets\lambda{\bf v}_{i}(t)+{\bf a}_{i}(t)\delta t\text{.}
\]</span></p>
<p>Существуют и другие подходы поддержания постоянной температуры в системе, они воспроизводят теплообмен с внешним источником тепловой энергии — <em>термостатом</em>, а сами называются <em>методами термостатирования</em>.</p>
<dl>
<dt>Термостат&nbsp;Берендсена</dt>
<dd>
<span class="citation" data-cites="Berendsen1984">[<a href="#ref-Berendsen1984" role="doc-biblioref">1</a>]</span> так же вводит масштабирующий коэффициент скорости <span class="math inline">\(\lambda_\t{B}\)</span> для каждого шага интегрирования: <span class="math display">\[\lambda_\t{B}=\sqrt{1+\dfrac{\delta t}{Q}\left(\dfrac{\Theta}{T(t)}-1\right)},\]</span> интенсивность теплообмена между системой и термостатом учитывается выбором <span class="math inline">\(Q\)</span>.
</dd>
<dt>Термостат&nbsp;Нозе-Гувера</dt>
<dd>
<span class="citation" data-cites="Nose1984 Hoover1985">[<a href="#ref-Nose1984" role="doc-biblioref">2</a>,<a href="#ref-Hoover1985" role="doc-biblioref">3</a>]</span> модифицирует уравнение движения <a href="1-interactions.html#eq-newton2law">Ур.&nbsp;<span>7.1</span></a>, масштабируя координаты и скорости системы через параметр <span class="math display">\[\lambda_\t{NG}=\dfrac{1}{Q}\left\{ \sum_{i}\dfrac{m_{i}{\bf v}_{i}^{2}(t)}{2}-3kN\Theta\right\} ,\]</span> где <span class="math inline">\(Q\)</span> учитывает интенсивность теплового обмена; задача МД сводится к решению систем уравнений движения вида <span class="math display">\[\dv[2]{\bf r_{i}(t)}{t}=\dfrac{{\bf F_{i}}}{m_{i}}-\lambda_\t{NG}{\bf v_{i}},\]</span> <span class="math inline">\(\lambda_\t{NG}\)</span> по сути является коэффициентом вязкого трения.
</dd>
<dt>Термостат&nbsp;Ланжевена</dt>
<dd>
<span class="citation" data-cites="Podryga2014 Davidchack2009 Brunger2020">[<a href="#ref-Podryga2014" role="doc-biblioref">4</a>–<a href="#ref-Brunger2020" role="doc-biblioref">6</a>]</span> основан на уравнениях движения броуновской динамики — вводятся две дополнительные силы: случайная составляющая <span class="math inline">\(\bf a\)</span>, вызывающая нагрев частиц, и диссипативная сила <span class="math inline">\(\bf b\)</span>, рассеивающая лишнюю энергию (по сути сила трения). Аналогично <a href="1-interactions.html#eq-newton2law">Ур.&nbsp;<span>7.1</span></a>, уравнение движения: <span class="math display">\[m_{i}\dv[2]{\bf r_{i}(t)}{t}=\sum_{i\ne j}{\bf F_{i,j}(t)+{\bf a_{i}+{\bf b_{i}\quad i,j=1..N,}}}\]</span> случайная составляющая распределена нормально: <span class="math display">\[\bf a_i \sim \cl N (\bf 0, \bm{\sigma}_i) \quad \t{и} \quad \sigma_i=\dfrac{m_i k \Theta}{\delta t \cdot Q},\]</span> где вектора <span class="math inline">\(\mathbf{0},\bm{\sigma}_{i}\in\mathbb{R}^{3}\)</span>, <span class="math inline">\(\sigma_{i}\)</span> — компонента <span class="math inline">\(\bm{\sigma}\)</span>, <span class="math inline">\(Q\)</span> — параметр теплового обмена, <span class="math inline">\(\Theta\)</span> — поддерживаемая температура. Для трения: <span class="math display">\[\mathbf{b}_{i}=-Q\dfrac{m_{i}}{2}\dv{\bf r_{i}}{t}.\]</span>
</dd>
</dl>
</section>
<section id="sec-pressure" class="level2">
<h2 class="anchored" data-anchor-id="sec-pressure">Давление</h2>
<p>Для описания макропараметров реальных систем одни параметры раскладывают в степенной ряд по другим, например, по обратным степеням молярного объёма: <span class="math display">\[
\dfrac{P}{RT}=\sum_{n=1}^{\infty}\dfrac{B_{i}(T)}{V_{m}^{n-1}},
\]</span> где <span class="math inline">\(B_{i}(T)\)</span> — функция, зависящая от температуры; такие уравнения называют <em>вириальными</em>. Вириальное уравнение не имеет чёткого физического смысла. Аналогичный подход используется и в МД, здесь мгновенное давление определяется вириальным соотношением</p>
<p><span class="math display">\[P(t)=\dfrac{1}{3V}\sum_{i}\left\{ \dfrac{{\bf p}_{i}^{2}(t)}{m_{i}}+\sum_{j\ne i}{\bf F}_{i}(t)\cdot{\bf r_{i,j}}\right\} ,\]</span> что, как и в случае температуры, противоречит предпосылкам NPT-ансамбля. Эту проблему решают алгоритмы <em>баростатирования</em>.</p>
<dl>
<dt>Баростат&nbsp;Берендсена</dt>
<dd>
<p><span class="citation" data-cites="Berendsen1984">[<a href="#ref-Berendsen1984" role="doc-biblioref">1</a>]</span> использует <em>принцип локального возмущения</em>, где изменение давления во времени определяется как <span class="math display">\[\dv{P(t)}{t}=\dfrac{\Phi-P(t)}{Q},\]</span> параметр <span class="math inline">\(Q\)</span> учитывает интенсивность баростата, <span class="math inline">\(\Phi\)</span> — поддерживаемое им давление путём изменения размера системы: объём масштабируется с помощью коэффициента <span class="math display">\[\xi_{B}=\dfrac{\beta_{T}}{3Q}\left\{ P(t)-\Phi\right\} ,\]</span> изменение объёма записывается как <span id="eq-delta-V"><span class="math display">\[\Delta V=V(t)-V, \tag{9.2}\]</span></span> уравнения движения принимают вид: <span class="math display">\[\dv{\bf r_{i}(t)}{t}={\bf v}_{i}-\xi_{B}{\bf r_{i}}.\]</span></p>
</dd>
<dt>Баростат&nbsp;Нозе-Гувера</dt>
<dd>
<p><span class="citation" data-cites="Nose1984 Hoover1985">[<a href="#ref-Nose1984" role="doc-biblioref">2</a>,<a href="#ref-Hoover1985" role="doc-biblioref">3</a>]</span> аналогично вводит масштабирующий множитель: <span class="math display">\[\dv{\bf \xi_{\text{NG}}}{t}=\dfrac{V(t)}{Q}\left\{ P(t)-\Phi\right\} ,\]</span> изменение объёма как в <a href="#eq-delta-V">Ур.&nbsp;<span>9.2</span></a>, уравнения движения: <span class="math display">\[\dv[2]{\bf r_{i}(t)}{t}=\dfrac{{\bf F_{i}}}{m_{i}}-\xi_{\text{NG}}{\bf v_{i}}.\]</span></p>
</dd>
<dt>Баростат&nbsp;Ланжевена</dt>
<dd>
<p><span class="citation" data-cites="Feller1995">[<a href="#ref-Feller1995" role="doc-biblioref">7</a>]</span> основан на уравнениях Ланжевена и броуновской динамике. Принципы, лежащие в основе приведены в <a href="#sec-temperature"><span>Глава&nbsp;9.1</span></a>, ввиду его сложных построений, ограничимся лишь указанием.</p>
</dd>
</dl>
</section>
<section id="размер" class="level2">
<h2 class="anchored" data-anchor-id="размер">Размер</h2>
<p>Если не наложены ограничения на размеры системы, она сама заполнит предоставленный ей объём, так можно описывать молекулы в вакууме или в газе, однако в ходе такого моделирования частицы разлетятся на огромные расстояния, и нам рано или поздно не хватит размера машинных чисел даже для простого задания координат; поэтому разумным приближением будет введение некой <em>ячейки моделирования</em>, подойдя к границе которой частицы испытают либо упругое соударение, либо их координаты будут транслированы на противоположную сторону этой ячейки.</p>
<p>Периодические граничных условия <span class="citation" data-cites="Bekker2004">[<a href="#ref-Bekker2004" role="doc-biblioref">8</a>]</span> могут задаваться прямоугольным параллелепипедом, гексагональной призмой, усечённым октаэдром, ромбическим додекаэдром; непериодические граничные условия можно задавать сферой.</p>
<p>В конденсированных фазах часто присутствует ближний и дальний порядок, это означает, что для описания всей системы достаточно описания небольшой её части. Здесь применение периодичности особенно полезно. Кроме того, за счёт изменения размеров ячейки моделирования возможно поддержание постоянного давления (<a href="#sec-pressure"><span>Глава&nbsp;9.2</span></a>).</p>


</section>
<section id="bibliography" class="level1 unnumbered">
<h1 class="unnumbered">Источники</h1>
<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-Berendsen1984" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Berendsen H.J.C. и др. <a href="https://doi.org/10.1063/1.448118">Molecular dynamics with coupling to an external bath</a> // The Journal of Chemical Physics. 1984. Т. 81, № 8. С. 3684–3690.</div>
</div>
<div id="ref-Nose1984" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Nosé S. <a href="https://doi.org/10.1063/1.447334">A unified formulation of the constant temperature molecular dynamics methods</a> // The Journal of Chemical Physics. 1984. Т. 81, № 1. С. 511–519.</div>
</div>
<div id="ref-Hoover1985" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Hoover W.G. <a href="https://doi.org/10.1103/PhysRevA.31.1695">Canonical dynamics: Equilibrium phase-space distributions</a> // Physical Review A. 1985. Т. 31, № 3. С. 1695–1697.</div>
</div>
<div id="ref-Podryga2014" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Подрыга В.О., Поляков С.В. Молекулярно-динамическое моделирование процесса установления термодинамического равновесия нагретого никеля // Препринты Института прикладной математики им. М. В Келдыша РАН. 2014. С. 20–41.</div>
</div>
<div id="ref-Davidchack2009" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Davidchack R.L., Handel R., Tretyakov M.V. <a href="https://doi.org/10.1063/1.3149788">Langevin thermostat for rigid body dynamics</a> // Journal of Chemical Physics. 2009. Т. 130, № 23.</div>
</div>
<div id="ref-Brunger2020" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Brünger A.T. X-plor version 3.1: A system for x-ray crystallography and NMR // Нью-Хейвен (Коннектикут): Yale Univ Press. 1992. С. 39.</div>
</div>
<div id="ref-Feller1995" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Feller S.E. и др. <a href="https://doi.org/10.1063/1.470648">Constant pressure molecular dynamics simulation: The Langevin piston method</a> // The Journal of Chemical Physics. American Institute of Physics, 1995. Т. 103, № 11. С. 4613–4621.</div>
</div>
<div id="ref-Bekker2004" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Bekker H., Van Den Berg J.P., Wassenaar T.A. <a href="https://doi.org/10.1002/jcc.20050">A method to obtain a near-minimal-volume molecular simulation of a macromolecule, using periodic boundary conditions and rotational constraints</a> // Journal of Computational Chemistry. 2004. Т. 25, № 8. С. 1037–1046.</div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопировано");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопировано");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../03-molecular-mechanics/2-integration.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Интегрирование уравнений движения</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../03-molecular-mechanics/4-force-fields.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">Силовые поля</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>